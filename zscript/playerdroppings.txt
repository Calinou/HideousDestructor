//-------------------------------------------------
// heh
//-------------------------------------------------
class HDDropOne:ActionItem{
	states{
	use:
		TNT1 A 0{
			if(!player||!player.readyweapon)return;
			name cw=player.readyweapon.getclassname();
			if(cw=="HDPistol"){
				if(countinv("HDPistolAmmo")){
					A_DropInventory("HDPistolAmmo",countinv("HDPistolAmmo"));
				}else A_DropInventory("HDPistolMag",1);
			}else if(cw=="HDSMG"){
				if(countinv("HDPistolAmmo")){
					A_DropInventory("HDPistolAmmo",countinv("HDPistolAmmo"));
				}else A_DropInventory("HDSMGMag",1);
			}else if(cw=="Hunter"||cw=="Slayer"){
				A_DropInventory("HDShellAmmo",4);
			}else if(cw=="ZM66AssaultRifle"){
				if(
					!(hdweapon(player.readyweapon).weaponstatus[0]&ZM66F_NOLAUNCHER)
				)A_DropInventory("HDRocketAmmo",1);
				if(countinv("FourMilAmmo"))
					A_DropInventory("FourMilAmmo",countinv("FourMilAmmo"));
				else A_DropInventory("ZM66RifleMags",1);
			}else if(cw=="Vulcanette"){
				if(countinv("HDCellAmmo"))A_DropInventory("HDCellAmmo",countinv("HDCellAmmo"));
				else A_DropInventory("HDCellPacks",1);
				if(countinv("FourMilAmmo"))
					A_DropInventory("FourMilAmmo",countinv("FourMilAmmo"));
				else A_DropInventory("ZM66RifleMags",1);
			}else if(cw=="HDRL"){
				if(countinv("HEATAmmo")){
					angle+=1;
					A_DropInventory("HDRocketAmmo",1);
					angle-=2;
					A_DropInventory("HEATAmmo",1);
					angle+=1;
				}else A_DropInventory("HDRocketAmmo",1);
			}
			else if(cw=="Blooper")A_DropInventory("HDRocketAmmo",1);
			else if(cw=="HDFragGrenades")A_DropInventory("HDFragGrenadeAmmo",1);
			else if(cw=="LiberatorRifle"){
				if(
					!(hdweapon(player.readyweapon).weaponstatus[0]&LIBF_NOLAUNCHER)
				)A_DropInventory("HDRocketAmmo",1);
				if(countinv("SevenMilAmmo"))
					A_DropInventory("SevenMilAmmo",countinv("SevenMilAmmo"));
				else A_DropInventory("LiberatorMag",1);
			}
			else if(cw=="Brontornis")A_DropInventory("BrontornisRound",1);
			else if(cw=="BossRifle"){
				if(countinv("SevenMilAmmo"))
					A_DropInventory("SevenMilAmmo",countinv("SevenMilAmmo"));
				else A_DropInventory("BossClip",1);
			}else if(cw=="ThunderBuster"||cw=="Lumberjack"){
				if(countinv("HDCellAmmo"))A_DropInventory("HDCellAmmo",countinv("HDCellAmmo"));
				else if(countinv("HDCellPackEmpty"))A_DropInventory("HDCellPackEmpty",1);
				else A_DropInventory("HDCellPacks",1);
			}else if(cw=="BFG9k"){
				if(countinv("HDCellAmmo"))A_DropInventory("HDCellAmmo",countinv("HDCellAmmo"));
				else if(countinv("HDCellPackEmpty")){
					angle+=1;
					A_DropInventory("HDCellPacks",1);
					angle-=2;
					A_DropInventory("HDCellPackEmpty",1);
					angle+=1;
				}else A_DropInventory("HDCellPacks",1);
			}else if(cw=="SelfBandage"){
				A_DropInventory("PortableStimpack",1);
				A_DropInventory("PortableMedikit",1);
				A_DropInventory("PortableBerserkPack",1);
				A_DropInventory("BluePotion",1);
			}else if(cw=="HDBP"){
				let hdbp=hdbp(findinventory("hdbp"));
				class<inventory> what=hdbp.itemtype[hdbp.weaponstatus[HDBPS_WHICH]];
				int howmany=min(1,countinv(what));
				if(!howmany)return;
				if(what=="HDShellAmmo")howmany=min(4,countinv(what));
				A_DropInventory(what,howmany);
			}else if(cw=="MagManager"){
				let mmm=MagManager(findinventory("MagManager"));
				class<inventory> what=mmm.ammotype[mmm.weaponstatus[HDMMS_WHICH]];
				int howmany=min(5,countinv(what));
				if(!howmany)return;
				A_DropInventory(what,howmany);
			}
			else A_GiveInventory("DropExtra");
		}fail;
	}
}

class DropMisc:ActionItem{
	states{
	pickup:
		TNT1 A 0{
			if(health<1)return;
			A_DropInventory("PortableLiteAmp");
			A_DropInventory("PortableLadder");
			A_DropInventory("HERPUsable");
			A_DropInventory("DERPUsable");
			A_DropInventory("HERPDEAD");
			A_DropInventory("DERPDEAD");
//			A_DropInventory("HDBlurSphere"); //too precious to drop casually
			A_DropInventory("PortableRadsuit",countinv("PortableRadsuit"));
			A_DropInventory("SquadSummoner",countinv("SquadSummoner"));
			A_DropInventory("HDIEDKit",countinv("HDIEDKit"));
			A_DropInventory("DudRocketAmmo",countinv("DudRocketAmmo"));
			A_DropInventory("HDArmour");
		}fail;
	}
}
class DropMeds:ActionItem{
	states{
	pickup:
		TNT1 A 0{
			A_DropInventory("PortableBerserkPack",8);
			A_DropInventory("PortableMedikit",8);
			A_DropInventory("PortableStimpack",8);
			A_DropInventory("BluePotion",8);
		}fail;
	}
}

class DropExtra:ActionItem{
	states{
	pickup:
		TNT1 A 0{
			if(
				!countinv("HDPistol")
				&&!countinv("HDSecondPistol")
				&&!countinv("HDSMG")
				&&!countinv("DERPUsable")
			){
				A_DropInventory("HDPistolAmmo",countinv("HDPistolAmmo"));
				A_DropInventory("HDSMGMag",countinv("HDSMGMag"));
				A_DropInventory("HDPistolMag",countinv("HDPistolMag"));
			}
			if(
				!countinv("Slayer")
				&&!countinv("Hunter")
			){
				A_DropInventory("HDShellAmmo",countinv("HDShellAmmo"));
			}
			if(
				!countinv("ZM66AssaultRifle")
				&&!countinv("Vulcanette")
				&&!countinv("HERPUsable")
			){
				A_DropInventory("ZM66RifleMags",countinv("ZM66RifleMags"));
				if(!countinv("LiberatorRifle")&&!countinv("BossRifle"))
					A_DropInventory("FourMilAmmo",countinv("FourMilAmmo"));
			}
			if(
				!countinv("HDRL")
			){
				A_DropInventory("HEATAmmo",countinv("HEATAmmo"));
				if(
					!countinv("Blooper")
					&&(
						!countinv("ZM66AssaultRifle")
						||hdweapon(findinventory("ZM66AssaultRifle")).weaponstatus[0]
							&ZM66F_NOLAUNCHER
					)
					&&!countinv("LiberatorRifle")
					&&(
						!countinv("LiberatorRifle")
						||hdweapon(findinventory("LiberatorRifle")).weaponstatus[0]
							&LIBF_NOLAUNCHER
					)
				)A_DropInventory("HDRocketAmmo",countinv("HDRocketAmmo"));
			}
			if(
				!countinv("LiberatorRifle")
				&&!countinv("BossRifle")
			){
				A_DropInventory("LiberatorMag",countinv("LiberatorMag"));
				A_DropInventory("BossClip",countinv("BossClip"));
				A_DropInventory("SevenMilAmmo",countinv("SevenMilAmmo"));
			}
			if(
				!countinv("BFG9k")
			){
				A_DropInventory("HDCellPackEmpty",countinv("HDCellPackEmpty"));
				if(
					!countinv("ThunderBuster")
					&&!countinv("Vulcanette")
					&&!countinv("Lumberjack")
					&&!countinv("HERPUsable")
				){
					A_DropInventory("HDCellPacks",countinv("HDCellPacks"));
					A_DropInventory("HDCellAmmo",countinv("HDCellAmmo"));
				}
			}
			if(!countinv("Brontornis"))
				A_DropInventory("BrontornisRound",countinv("BrontornisRound"));
			if(!countinv("HDIEDKit"))
				A_DropInventory("DudRocketAmmo",countinv("DudRocketAmmo"));
			double aaa=angle;
			angle+=frandom(-10,10);A_DropInventory("DERPDEAD");
			angle+=frandom(-10,10);A_DropInventory("HERPDEAD");
			angle=aaa;
		}fail;
	}
}


